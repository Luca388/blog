---
layout: post
categories: OS
tags: CPU
---
# CPU 스케줄링
## CPU스케줄링이란?

운영체제가 프로세스들에게 공정하고 합리적으로 CPU자원을 배분하는것을 CPU스케줄링이라고 한다.
## 프로세스 우선순위 
입출력 작업이 많은 프로세스를 **입출력 집중 프로세스**라고 하고 CPU 작업이 많은 프로세스를 CPU집중 프로세스라고 한다.
> cpu를 이용하는 작업을 *cpu버스트*라고 하고 입출력장치를 기다리는 작업을 I/O burst라고 한다.

> 프로세스의 우선순위는 PCB에 저장된다.

# 스케줄링 큐 
자원을 이용하고 싶은 프로세스들을 관리하는 큐 
## 준비 큐 
cpu를 이용하고 싶은 프로세스들이 있는 큐 
## 대기 큐
입출력 장치를 이용하기 위해 대기 상태에 접어든 프로세스들이 서는 큐

## 선점형 스케줄링
프로세스가 자원을 사용하고 있더라도 운영체제가 자원을 강제로 빼앗아 다른 프로세스에 할당할수있는 방식
## 비선점형 스케줄링
하나의 프로세스가 자원을 사용하고 있다면 그 프로세스가 종료되거나 스스로 대기 상태에 접어들기 전까진 다른 프로세스가 끼어들 수 없는 스케줄링 방식





---


# CPU 스케줄링 알고리즘의 종류
## 1. 선입 선처리 스케줄링(FCFS Scheduling)
 >준비된 큐에 삽입된 순서대로 프로세스들을 처리하는 비선점형 스케줄링 방식이다.
 즉,CPU를 먼저 요청한 프로세스부터 CPU를 할당하는 스케줄링 방식이다.
 
 - 호위효과
 
 >앞선 프로세스가 실행시간이 길다면 실행시간이 짧은 프로세스들이 실행되지 못해 마치 부하처럼 뒤따라서 기다리고 있다는 것을 가리키는 효과이다.


## 2. 최단 작업 우선 스케줄링(SJF Sc heduling)
>준비 큐에 삽입된 프로세스들 중 CPU 이용시간의 길이가 가장짧은 프로세스부터 실행하는 스케줄링 방식.

최단 작업 우선 스케줄링은 기본적으로 비선점형 스케줄링 알고리즘으로 분류되지만, 선점형으로 구현될수도 있다.

## 3. 라운드 로빈 스케줄링(round robin scheduling)
- 선입 선처리 스케줄링에 타임슬라이스라는 개념이 더해진 스케줄링 방식.
>*타임 슬라이스란* 각 프로세스가 CPU를 사용할수있는 정해진 시간을 의미한다.

즉, 라운드 로빈 스케줄링은 정해진 타임 슬라이스 만큼의 시간동안 돌아가면 CPU를 이용하는 선점형 스케줄링이다.
큐에 삽입된 프로세스들은 삽입된 순서대로 CPU를 이용하되 정해진 시간만큼만 CPU를 이용하고 정해진 시간을 모두 사용하였음에도 아직 프로세스가 완료되지않았다면 다시 큐의 맨 뒤에 삽입된다.
이떄 문맥교환이 발생한다.

라운드 로빈 스케줄링에서는 타임 슬라이스 크기가 매우중요하다. 
타임 슬라이스가 지나치게 크면 사실상 선입 선처리 스케줄링과 다를 바 없어 호위 효과가 생길 여지가 있고, 타임 슬라이스가 지나치게 작으면 문맥교환에 발생하는 비용이 커 CPU는 프로세스를 처리하는 일보다 프로세스를 전환하는데 온 힘을 다쓸 여지가 있기 떄문이다.

## 4.최소 잔여 시간 우선 스케줄링(SRT)
- 최단 작업 우선 스케줄링 알고리즘과 라운드 로빈 알고리즘을 합친 스케줄링 방식.
>
최소 잔여시간 우선 스케줄링 하에서 프로세스들은 정해진 타임 슬라이스만큼 CPU를 사용하되 CPU를 사용할 다음 프로세스로는 남아있는 작업 시간이 가장적은 프로새스가 선택된다.

## 5. 우선 순위 스케줄링
- 프로세스들에 우선순위를 부여하고 ,가장높은 우선순위를 가진 프로세스부터 실행하는 스케줄링 알고리즘이다.(우선 순위가 같은 프로세스들은 선입 선처리로 스케줄링된다.)


우선순위 스케줄링은 근본적인 문제를 내포하고 있다. 우선순위가 높은 프로세스를 우선하여 처리하는 방식이기에 우선순위가 낮은 프로세스는(준비 큐에 먼저 삽입되었음에도 불구하고) 우선순위가 높은 프로세스들에 의해 실행이 계속해서 연기될수 있다. 이를 *** 기아 (starvation)*** 현상이라고 한다.

이를 방지하기 위한 대표적인 기법으로 ***에이징(aging)*** 이 있다.
이는 오랫동안 대기한 프로세스의 우선순위를 점차 높이는 방식이다.

## 6. 다단계 큐 스케줄링(multilevel queue scheduling)
우선순위별로 준비 큐를 여러 개 사용하는 스케줄링 방식이다 (준비 큐에 우선순위가 부여됨). 
다단계 큐 스케줄링 하에서는 우선순위가 가장 높은 큐에 있는 프로세스들을 먼저 처리하고, 우선순위가 가장 높은 큐가 비어있으면 그다음 우선순위 큐에 있는 프로세스들을 처리한다;.

큐를 여러 개 두면 프로세스 유형별로 우선순위를 구분하여 실행하는 것이 편리해진다. 가령 어떤 큐에는 우선순위가 비교적 높아야 하는 CPU 집중 프로세스가 삽입될 수 있고. 어떤 큐에는 우선순위가 비교적 낮아도 상관없는 입출력 집중 프로세스가 삽입될수 있다.
또 어떤 큐에는 (우선순위가 비교적 높아야 하는) 백그라운드 프로세스들을 삽입할 수 있고, 어떤 큐에는 (우선순위가 비교적 낮아도 무방한) 사용자와의 상호작용이 잦은 프로세스들을 삽입할수 있다.
또한 큐별로 타임슬라이스를 여러개 지정할 수도 있고, 큐마다 다른 스케줄링 알고리즘을 사용할수 도 있다.
예를 들어 어떤 큐에서의 타임슬라이스는 크게,어떤 큐에서의 타임 슬라이스는 작게 사용하고 ,어떤 큐에서는 선입 선처리 스케줄링을 사용하고,어떤 큐에서는 라운드 로빈 스케줄링을 사용할수도 있다.


## 7.다단계 피드백 큐 스케줄링(multilevel feedback queue scheduling)
다단게 피드백 큐 스케줄링은 다단계 큐 스케줄링의 발전된 형태이다.
다단계 큐 스케줄링에서는 프로세스들이 큐 사이를 이동할수 없다.그러나 이런 방식대로면 우선순위가 낮은 프로세스는 계속 연기될 여지가 있다.
즉, 기아현상이 발생할수 있다. 이를 보완한 스케줄링 알고리즘이 **다단계 피드백 큐 스케줄링** 이다.

다단계 피드백 큐 스케줄링은 다단계 큐 스케줄링과 비슷하게 작동하지만 , 한가지가 다르다.다단계 큐 피드백 스케줄링은 프로세스들이 큐 사이를 이동할수 있다.
다단계 피드백 큐 스케줄링에서 새로 준비 상태가 된 프로세스가 있다면 우선 우선순위가 가장 높은 큐에 삽입되고 일정시간(타임 슬라이스) 동안 실행된다.
그리고 만약 프로세스가 해당 큐에서 실행이 끝나지 않는다면 다음 우선순위 큐에 삽입되어 실행된다.    그리고 또 해당 큐에서 실행이 끝나지 않는다면 프로세스는 또 다음 우선순위 큐에 삽입되고,결국 CPU를 오래사용해야하는 프로세스는 점차 우선순위가 낮아진다.
즉, CPU를 비교적 오래 사용해야 하는 CPU집중 프로세스들은 자연스레 우선순위가 낮아지고, CPU를 비교적 적게 사용하는 입출력집중 프로세스들은 자연스레 우선순위가 높은 큐에서 실행이 끝난다.
다단계 피드백 큐 스케줄링은 큐 사이를 이동할수있는 방식이기 때문에 낮은 우선순위의 큐에서 너무 오래 기다리고 있는 프로세스가 잇다면 점차 우선순위가 높은 큐로 이동시키는 *에이징* 기법을 사용하여 기아 현상을 예방할수있다.


즉, 다단게 피드백 큐 스케줄링 알고리즘은 어떤 프로세스의 CPU 이용시간이 기면 낮은 우선순위 큐로 이동시키고,어떤 프로세스가 낮은우선순위 큐에서 너무 오래 기다린다면 높은 우선순위 큐로 이동시킬수 있는 알고리즘 이다 .

다단계 피드백 큐 스케줄링은 구현이 복잡하지만 , 가장 일반적인CPU 스케줄링 알고리즘으로 알려져있다.