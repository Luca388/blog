---
layout: post
categories: OS
title: file system
---
# 파일과 디렉터리
## file 
의미있고 관련있는 정보를 모은 논리적 단위

- 속성,metadata
> 파일 관련 부가 정보

# directory
해당 디렉터리에 당겨있는 대상과 관련된 정보를 담고 있다.

보통 테이블형태로 구성되고 저장된다.

많은 운영체제는 디렉터리를 그저 '특별한 형태의 파일'로 간주한다.

- directory entry
는 테 이블의 행이다.

# file system
파일과 디렉터리를 보조기억장치에 일목요연하게 저장하고 접근 할 수 있게 하는 운영체제 내부 프로그램.

## partitioning
하드 디스크나 ssd처럼 용량이 큰 저장장치를 하나 이상의 논리적인 단위로 구획하는것.

이러한 파티셔닝 작업을 통해 나눠어진 영역 하나하나를 partition 이라고 한다.


## formatting 
파일 시스템을 설정하여  어떤 방식으로 파일을 저장하고 관리할 것인지를 결정하고, 새로운 데이터를 쓸 준비를 하는 작업

> 포매팅의 종류에는 *저수준 포매팅*과 *논리적 포매팅*이 있다.
전자는 저장장치를 생성할 당시 공장에서 수행되는 물리적인 포매팅이고,후자는 파일 시스템을 생성하는 포매팅이다.

# 파일 할당 방법
운영체제는 파일과 디렉터리를 block 단위로 일고 쓴다.

즉 하나의 파일이 보조기억장치에 저장될 때는 하나 이상의 블록에 걸쳐 저장된다.

파일을 보조기억장치에 할당하는 방법에는 크게 두가지가 있다. 연속 할당과 불연속 할당이다, 그리고 불연속 할당에는 크게 *연결 할당,색인할당*이 있다. 현재까지 쓰이고 있는 방식은 불연속 할당이다.

## contiguous allocation
연결할당은 가장 단순한 방식이다,이름 그대로 보조기억장치 내 연속적인 블록에 파일을 할당하는 방식이며 외부단편화를 야기 할수 있다.

디렉터리 엔트리에 파일 이름과 더불어 첫번째 블록주소와 블록 단위의 길이를 명시한다.
## linked allocation
연결 할당은 각 블록 일부에 다음 블록의 주소를 저장하여 각 블록이 다음 블록을 가리키는 형태로 할당하는 방식이다. 즉 파일을 이루는 데이터를 연결리스트로 관리한다.

디렉터리엔트리에 파일 이름과 더불어 첫 번쨰 블록 주소와 블록다누이의 길이를 명시한다.

- 단점
> 반드시 첫 번쨰 블록부터 하나씩 차례대로 읽어야한다.

파일의 중간 부분부터 접근하고 싶어도 반드시 파일의 첫 번째 블록부터 접근하여 하나씩 차례대로 일거야한다.

즉 파일내 임의의 위치에 접근하는 속도, random access 속도가 매우 느리다


> 하드웨어 고장이나 오류 발생 시 해당 블록 이후 블록은 접근할수 없다.
하나의 블록안에 파일 데이터와 다음 블록 주소가 모두 포함되어 있다 보니 ,하드웨어 고장이나 오류로 인해 파일을 이루는 블록에 하나라도 문제가 발생하면  그 블록 이후의 블록에 접근할수 없다.

이 내용을 조금 변형한 대표적인 파일 시스템은 FAT file system 이 있다


## indexed allocation
색인 할당은 파일의 모든 블록 주소를 index block 이라는 하나의 블록에 모아 관리하는 방식이다.

색인 블록안에 파일을 구성하는 데이터 블록 주소가 있으므로 색인 블록만 알면 해당 파일 데이터에 접근할수 있다.그렇기에 색인 할당을 사용하는 파일 시스템에서는 디렉터리 엔트리에 파일 이름과 더불어 색인 블록 주소를 명시한다.

색인 할당을 기반으로 만든유닉스 파일 시스템이 있다

# 파일 시스템 살펴보기
저용량 저장 장치에 사용되는 FAT file system 와 유닉스 계열에서 사용되는 UNIX file system 이 있다.

## FAT file system
linked allocation 에서 각 블록에 포함된 다음 블록의 주소들을 한데 모아 테이블 형태로 관리하는 것을  FAT(File allocation talbe)이라고 부른다.

디렉터리 엔트리에는 파일 이름과 더불어 파일의 첫번째 블록 주소가 명시된다.FAT 파일 시스템은 버전에 따라 FAT12 FAT16 FAT32가 있으며 FAT뒤에 오는 숫자는 블록을 표현하는 비트수를 의미한다

> 윈도우에서는 블록이라는 용어대신 **클러스터**라는 용어를 사용한다

FAT 파일 시스템에서 FAT은 파티션의 앞부분에 만들어진다

파일 속성 정보가 디렉터리 엔트리에 저장된다
## UNIX file system
유닉스에서는 색인 블록을 기반으로 데이터를 찾고 유닉스파일 시스템에서는 이  색인 블록을 **i-node(index-node)**라고 부른다.

i-node에는 파일 속성 정보와 열 다섯개의 블록 주소가 저장될수 있다. 파일 속성 정보는 i-node 에 표현된다

유닉스 파일 시스템에는 파일 마다 i-node 가 있고 i-node마다 번호가 부여되어있다,그리고 i-node들은 파티션 내 특정 영역에 모여있다.

## direct block 
i-node가 가리킬수 있는 15개의 블록중 1~12까지는 데이터가 직접 명시된다 이를 직접 블록이라한다.

## single indirect block
direct block 으로 충분하지 않다면 13 번쨰에는 단일간접 블록의 주소를 지정한다 

단일 간접블록은 파일데이터를 저장한 블록주소가 저장된 블록을 의미한다

## double indirect block 
충분하지 않다면 14번쨰에 이중간접 블록을 저장한다

단일 간접 브록 들의 주소를 저장한는 블록이 이중 간접 블록이다
## triple indirect block 
이중 간접 블록주소가 저장된 블록

# journaling file system
저널링 기법 이란 작업 로그를 통해 시스템 크래시가 발생했을떄 빠르게 복구하기 위한 방법

# 마운트 
한 저장 장치의 파일 시스템에서 다른 저장 장치의 파일 시스템에 접근할 수 있도록 파일 시스템을 편입 시키는 작업